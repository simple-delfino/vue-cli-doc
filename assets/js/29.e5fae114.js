(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{409:function(e,t,s){"use strict";s.r(t);var a=s(46),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"build-targets"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#build-targets"}},[e._v("#")]),e._v(" Build Targets")]),e._v(" "),s("p",[e._v("When you run "),s("code",[e._v("vue-cli-service build")]),e._v(", you can specify different build targets via the "),s("code",[e._v("--target")]),e._v(" option. This allows you to use the same code base to produce different builds for different use cases.")]),e._v(" "),s("h2",{attrs:{id:"app"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#app"}},[e._v("#")]),e._v(" App")]),e._v(" "),s("p",[e._v("App is the default build target. In this mode:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("index.html")]),e._v(" with asset and resource hints injection")]),e._v(" "),s("li",[e._v("vendor libraries split into a separate chunk for better caching")]),e._v(" "),s("li",[e._v("static assets under 4kb are inlined into JavaScript")]),e._v(" "),s("li",[e._v("static assets in "),s("code",[e._v("public")]),e._v(" are copied into output directory")])]),e._v(" "),s("h2",{attrs:{id:"library"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#library"}},[e._v("#")]),e._v(" Library")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("Note on Vue Dependency")]),e._v(" "),s("p",[e._v("In lib mode, Vue is "),s("em",[e._v("externalized")]),e._v(". This means the bundle will not bundle Vue even if your code imports Vue. If the lib is used via a bundler, it will attempt to load Vue as a dependency through the bundler; otherwise, it falls back to a global "),s("code",[e._v("Vue")]),e._v(" variable.")]),e._v(" "),s("p",[e._v("To avoid this behavior provide "),s("code",[e._v("--inline-vue")]),e._v(" flag to "),s("code",[e._v("build")]),e._v(" command.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vue-cli-service build --target lib --inline-vue\n")])])])]),e._v(" "),s("p",[e._v("You can build a single entry as a library using")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vue-cli-service build --target lib --name myLib [entry]\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("File                     Size                     Gzipped\n\ndist/myLib.umd.min.js    13.28 kb                 8.42 kb\ndist/myLib.umd.js        20.95 kb                 10.22 kb\ndist/myLib.common.js     20.57 kb                 10.09 kb\ndist/myLib.css           0.33 kb                  0.23 kb\n")])])]),s("p",[e._v("The entry can be either a "),s("code",[e._v(".js")]),e._v(" or a "),s("code",[e._v(".vue")]),e._v(" file. If no entry is specified, "),s("code",[e._v("src/App.vue")]),e._v(" will be used.")]),e._v(" "),s("p",[e._v("A lib build outputs:")]),e._v(" "),s("ul",[s("li",[s("p",[s("code",[e._v("dist/myLib.common.js")]),e._v(": A CommonJS bundle for consuming via bundlers (unfortunately, webpack currently does not support ES modules output format for bundles yet)")])]),e._v(" "),s("li",[s("p",[s("code",[e._v("dist/myLib.umd.js")]),e._v(": A UMD bundle for consuming directly in browsers or with AMD loaders")])]),e._v(" "),s("li",[s("p",[s("code",[e._v("dist/myLib.umd.min.js")]),e._v(": Minified version of the UMD build.")])]),e._v(" "),s("li",[s("p",[s("code",[e._v("dist/myLib.css")]),e._v(": Extracted CSS file (can be forced into inlined by setting "),s("code",[e._v("css: { extract: false }")]),e._v(" in "),s("code",[e._v("vue.config.js")]),e._v(")")])])]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("If you are developing a library or in a monorepo, please be aware that CSS imports "),s("strong",[e._v("are side effects")]),e._v(". Make sure to "),s("strong",[e._v("remove")]),e._v(" "),s("code",[e._v('"sideEffects": false')]),e._v(" in the "),s("code",[e._v("package.json")]),e._v(", otherwise CSS chunks will be dropped by webpack in production builds.")])]),e._v(" "),s("h3",{attrs:{id:"vue-vs-js-ts-entry-files"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-vs-js-ts-entry-files"}},[e._v("#")]),e._v(" Vue vs. JS/TS Entry Files")]),e._v(" "),s("p",[e._v("When using a "),s("code",[e._v(".vue")]),e._v(" file as entry, your library will directly expose the Vue component itself, because the component is always the default export.")]),e._v(" "),s("p",[e._v("However, when you are using a "),s("code",[e._v(".js")]),e._v(" or "),s("code",[e._v(".ts")]),e._v(" file as your entry, it may contain named exports, so your library will be exposed as a Module. This means the default export of your library must be accessed as "),s("code",[e._v("window.yourLib.default")]),e._v(" in UMD builds, or as "),s("code",[e._v("const myLib = require('mylib').default")]),e._v(" in CommonJS builds. If you don't have any named exports and wish to directly expose the default export, you can use the following webpack configuration in "),s("code",[e._v("vue.config.js")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  configureWebpack"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    output"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      libraryExport"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'default'")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("h2",{attrs:{id:"web-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-component"}},[e._v("#")]),e._v(" Web Component")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("Note on Compatibility")]),e._v(" "),s("p",[e._v("Web Component mode does not support IE11 and below. "),s("a",{attrs:{href:"https://github.com/vuejs/vue-web-component-wrapper#compatibility",target:"_blank",rel:"noopener noreferrer"}},[e._v("More details"),s("OutboundLink")],1)])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("Note on Vue Dependency")]),e._v(" "),s("p",[e._v("In web component mode, Vue is "),s("em",[e._v("externalized.")]),e._v(" This means the bundle will not bundle Vue even if your code imports Vue. The bundle will assume "),s("code",[e._v("Vue")]),e._v(" is available on the host page as a global variable.")]),e._v(" "),s("p",[e._v("To avoid this behavior provide "),s("code",[e._v("--inline-vue")]),e._v(" flag to "),s("code",[e._v("build")]),e._v(" command.")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vue-cli-service build --target wc --inline-vue\n")])])])]),e._v(" "),s("p",[e._v("You can build a single entry as a web component using")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vue-cli-service build --target wc --name my-element [entry]\n")])])]),s("p",[e._v("Note that the entry should be a "),s("code",[e._v("*.vue")]),e._v(" file. Vue CLI will automatically wrap and register the component as a Web Component for you, and there's no need to do this yourself in "),s("code",[e._v("main.js")]),e._v(". You can use "),s("code",[e._v("main.js")]),e._v(" as a demo app solely for development.")]),e._v(" "),s("p",[e._v("The build will produce a single JavaScript file (and its minified version) with everything inlined. The script, when included on a page, registers the "),s("code",[e._v("<my-element>")]),e._v(" custom element, which wraps the target Vue component using "),s("code",[e._v("@vue/web-component-wrapper")]),e._v(". The wrapper automatically proxies properties, attributes, events and slots. See the "),s("a",{attrs:{href:"https://github.com/vuejs/vue-web-component-wrapper",target:"_blank",rel:"noopener noreferrer"}},[e._v("docs for "),s("code",[e._v("@vue/web-component-wrapper")]),s("OutboundLink")],1),e._v(" for more details.")]),e._v(" "),s("p",[s("strong",[e._v("Note the bundle relies on "),s("code",[e._v("Vue")]),e._v(" being globally available on the page.")])]),e._v(" "),s("p",[e._v("This mode allows consumers of your component to use the Vue component as a normal DOM element:")]),e._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("script")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')]),e._v("https://unpkg.com/vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("script")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')]),e._v("path/to/my-element.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("\x3c!-- use in plain HTML, or in any other framework --\x3e")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("my-element")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("my-element")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n")])])]),s("h3",{attrs:{id:"bundle-that-registers-multiple-web-components"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bundle-that-registers-multiple-web-components"}},[e._v("#")]),e._v(" Bundle that Registers Multiple Web Components")]),e._v(" "),s("p",[e._v("When building a web component bundle, you can also target multiple components by using a glob as entry:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vue-cli-service build --target wc --name foo 'src/components/*.vue'\n")])])]),s("p",[e._v("When building multiple web components, "),s("code",[e._v("--name")]),e._v(" will be used as the prefix and the custom element name will be inferred from the component filename. For example, with "),s("code",[e._v("--name foo")]),e._v(" and a component named "),s("code",[e._v("HelloWorld.vue")]),e._v(", the resulting custom element will be registered as "),s("code",[e._v("<foo-hello-world>")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"async-web-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#async-web-component"}},[e._v("#")]),e._v(" Async Web Component")]),e._v(" "),s("p",[e._v("When targeting multiple web components, the bundle may become quite large, and the user may only use a few of the components your bundle registers. The async web component mode produces a code-split bundle with a small entry file that provides the shared runtime between all the components, and registers all the custom elements upfront. The actual implementation of a component is then fetched on-demand only when an instance of the corresponding custom element is used on the page:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vue-cli-service build --target wc-async --name foo 'src/components/*.vue'\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("File                Size                        Gzipped\n\ndist/foo.0.min.js    12.80 kb                    8.09 kb\ndist/foo.min.js      7.45 kb                     3.17 kb\ndist/foo.1.min.js    2.91 kb                     1.02 kb\ndist/foo.js          22.51 kb                    6.67 kb\ndist/foo.0.js        17.27 kb                    8.83 kb\ndist/foo.1.js        5.24 kb                     1.64 kb\n")])])]),s("p",[e._v("Now on the page, the user only needs to include Vue and the entry file:")]),e._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("script")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')]),e._v("https://unpkg.com/vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("script")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')]),e._v("path/to/foo.min.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("\x3c!-- foo-one's implementation chunk is auto fetched when it's used --\x3e")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("foo-one")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("foo-one")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n")])])]),s("h2",{attrs:{id:"using-vuex-in-builds"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-vuex-in-builds"}},[e._v("#")]),e._v(" Using vuex in builds")]),e._v(" "),s("p",[e._v("When building a "),s("a",{attrs:{href:"#web-component"}},[e._v("Webcomponent")]),e._v(" or "),s("a",{attrs:{href:"#library"}},[e._v("Library")]),e._v(", the entry point is not "),s("code",[e._v("main.js")]),e._v(", but an "),s("code",[e._v("entry-wc.js")]),e._v(" file, generated here: "),s("a",{attrs:{href:"https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli-service/lib/commands/build/resolveWcEntry.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli-service/lib/commands/build/resolveWcEntry.js"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("So to use vuex in web component target, you need to initialize the store in "),s("code",[e._v("App.vue")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" store "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./store'")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("default")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  store"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'App'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);