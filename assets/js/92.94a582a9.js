(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{457:function(e,t,v){"use strict";v.r(t);var s=v(46),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"环境变量和模式"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#环境变量和模式"}},[e._v("#")]),e._v(" 环境变量和模式")]),e._v(" "),v("p",[e._v("你可以替换你的项目根目录中的下列文件来指定环境变量：")]),e._v(" "),v("div",{staticClass:"language-bash extra-class"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[e._v(".env                "),v("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 在所有的环境中被载入")]),e._v("\n.env.local          "),v("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 在所有的环境中被载入，但会被 git 忽略")]),e._v("\n.env."),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("mode"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("         "),v("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 只在指定的模式中被载入")]),e._v("\n.env."),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("mode"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(".local   "),v("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 只在指定的模式中被载入，但会被 git 忽略")]),e._v("\n")])])]),v("p",[e._v("一个环境文件只包含环境变量的“键=值”对：")]),e._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("FOO=bar\nVUE_APP_SECRET=secret\n")])])]),v("p",[e._v("被载入的变量将会对 "),v("code",[e._v("vue-cli-service")]),e._v(" 的所有命令、插件和依赖可用。")]),e._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[e._v("环境加载属性")]),e._v(" "),v("p",[e._v("为一个特定模式准备的环境文件 (例如 "),v("code",[e._v(".env.production")]),e._v(") 将会比一般的环境文件 (例如 "),v("code",[e._v(".env")]),e._v(") 拥有更高的优先级。")]),e._v(" "),v("p",[e._v("此外，Vue CLI 启动时已经存在的环境变量拥有最高优先级，并不会被 "),v("code",[e._v(".env")]),e._v(" 文件覆写。")])]),e._v(" "),v("div",{staticClass:"custom-block warning"},[v("p",{staticClass:"custom-block-title"},[e._v("NODE_ENV")]),e._v(" "),v("p",[e._v("如果在环境中有默认的 "),v("code",[e._v("NODE_ENV")]),e._v("，你应该移除它或在运行 "),v("code",[e._v("vue-cli-service")]),e._v(" 命令的时候明确地设置 "),v("code",[e._v("NODE_ENV")]),e._v("。")])]),e._v(" "),v("h2",{attrs:{id:"模式"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#模式"}},[e._v("#")]),e._v(" 模式")]),e._v(" "),v("p",[v("strong",[e._v("模式")]),e._v("是 Vue CLI 项目中一个重要的概念。默认情况下，一个 Vue CLI 项目有三个模式：")]),e._v(" "),v("ul",[v("li",[v("code",[e._v("development")]),e._v(" 模式用于 "),v("code",[e._v("vue-cli-service serve")])]),e._v(" "),v("li",[v("code",[e._v("production")]),e._v(" 模式用于 "),v("code",[e._v("vue-cli-service build")]),e._v(" 和 "),v("code",[e._v("vue-cli-service test:e2e")])]),e._v(" "),v("li",[v("code",[e._v("test")]),e._v(" 模式用于 "),v("code",[e._v("vue-cli-service test:unit")])])]),e._v(" "),v("p",[e._v("注意模式不同于 "),v("code",[e._v("NODE_ENV")]),e._v("，一个模式可以包含多个环境变量。也就是说，每个模式都会将 "),v("code",[e._v("NODE_ENV")]),e._v(" 的值设置为模式的名称——比如在 development 模式下 "),v("code",[e._v("NODE_ENV")]),e._v(" 的值会被设置为 "),v("code",[e._v('"development"')]),e._v("。")]),e._v(" "),v("p",[e._v("你可以通过为 "),v("code",[e._v(".env")]),e._v(" 文件增加后缀来设置某个模式下特有的环境变量。比如，如果你在项目根目录创建一个名为 "),v("code",[e._v(".env.development")]),e._v(" 的文件，那么在这个文件里声明过的变量就只会在 development 模式下被载入。")]),e._v(" "),v("p",[e._v("你可以通过传递 "),v("code",[e._v("--mode")]),e._v(" 选项参数为命令行覆写默认的模式。例如，如果你想要在构建命令中使用开发环境变量，请在你的 "),v("code",[e._v("package.json")]),e._v(" 脚本中加入：")]),e._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v('"dev-build": "vue-cli-service build --mode development",\n')])])]),v("h2",{attrs:{id:"示例：staging-模式"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#示例：staging-模式"}},[e._v("#")]),e._v(" 示例：Staging 模式")]),e._v(" "),v("p",[e._v("假设我们有一个应用包含以下 "),v("code",[e._v(".env")]),e._v(" 文件：")]),e._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("VUE_APP_TITLE=My App\n")])])]),v("p",[e._v("和 "),v("code",[e._v(".env.staging")]),e._v(" 文件：")]),e._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("NODE_ENV=production\nVUE_APP_TITLE=My App (staging)\n")])])]),v("ul",[v("li",[v("p",[v("code",[e._v("vue-cli-service build")]),e._v(" 会加载可能存在的 "),v("code",[e._v(".env")]),e._v("、"),v("code",[e._v(".env.production")]),e._v(" 和 "),v("code",[e._v(".env.production.local")]),e._v(" 文件然后构建出生产环境应用；")])]),e._v(" "),v("li",[v("p",[v("code",[e._v("vue-cli-service build --mode staging")]),e._v(" 会在 staging 模式下加载可能存在的 "),v("code",[e._v(".env")]),e._v("、"),v("code",[e._v(".env.staging")]),e._v(" 和 "),v("code",[e._v(".env.staging.local")]),e._v(" 文件然后构建出生产环境应用。")])])]),e._v(" "),v("p",[e._v("这两种情况下，根据 "),v("code",[e._v("NODE_ENV")]),e._v("，构建出的应用都是生产环境应用，但是在 staging 版本中，"),v("code",[e._v("process.env.VUE_APP_TITLE")]),e._v(" 被覆写成了另一个值。")]),e._v(" "),v("h2",{attrs:{id:"在客户端侧代码中使用环境变量"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#在客户端侧代码中使用环境变量"}},[e._v("#")]),e._v(" 在客户端侧代码中使用环境变量")]),e._v(" "),v("p",[e._v("只有以 "),v("code",[e._v("VUE_APP_")]),e._v(" 开头的变量会被 "),v("code",[e._v("webpack.DefinePlugin")]),e._v(" 静态嵌入到客户端侧的包中。你可以在应用的代码中这样访问它们：")]),e._v(" "),v("div",{staticClass:"language-js extra-class"},[v("pre",{pre:!0,attrs:{class:"language-js"}},[v("code",[e._v("console"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),v("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("process"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("env"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),v("span",{pre:!0,attrs:{class:"token constant"}},[e._v("VUE_APP_SECRET")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),v("p",[e._v("在构建过程中，"),v("code",[e._v("process.env.VUE_APP_SECRET")]),e._v(" 将会被相应的值所取代。在 "),v("code",[e._v("VUE_APP_SECRET=secret")]),e._v(" 的情况下，它会被替换为 "),v("code",[e._v('"secret"')]),e._v("。")]),e._v(" "),v("p",[e._v("除了 "),v("code",[e._v("VUE_APP_*")]),e._v(" 变量之外，在你的应用代码中始终可用的还有两个特殊的变量：")]),e._v(" "),v("ul",[v("li",[v("code",[e._v("NODE_ENV")]),e._v(" - 会是 "),v("code",[e._v('"development"')]),e._v("、"),v("code",[e._v('"production"')]),e._v(" 或 "),v("code",[e._v('"test"')]),e._v(" 中的一个。具体的值取决于应用运行的"),v("a",{attrs:{href:"#%E6%A8%A1%E5%BC%8F"}},[e._v("模式")]),e._v("。")]),e._v(" "),v("li",[v("code",[e._v("BASE_URL")]),e._v(" - 会和 "),v("code",[e._v("vue.config.js")]),e._v(" 中的 "),v("code",[e._v("publicPath")]),e._v(" 选项相符，即你的应用会部署到的基础路径。")])]),e._v(" "),v("p",[e._v("所有解析出来的环境变量都可以在 "),v("code",[e._v("public/index.html")]),e._v(" 中以 "),v("RouterLink",{attrs:{to:"/zh/guide/html-and-static-assets.html#插值"}},[e._v("HTML 插值")]),e._v("中介绍的方式使用。")],1),e._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[e._v("提示")]),e._v(" "),v("p",[e._v("你可以在 "),v("code",[e._v("vue.config.js")]),e._v(" 文件中计算环境变量。它们仍然需要以 "),v("code",[e._v("VUE_APP_")]),e._v(" 前缀开头。这可以用于版本信息:")]),e._v(" "),v("div",{staticClass:"language-js extra-class"},[v("pre",{pre:!0,attrs:{class:"language-js"}},[v("code",[e._v("process"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("env"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),v("span",{pre:!0,attrs:{class:"token constant"}},[e._v("VUE_APP_VERSION")]),e._v(" "),v("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),v("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./package.json'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("version\n\nmodule"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),v("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),v("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// config")]),e._v("\n"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])]),e._v(" "),v("h2",{attrs:{id:"只在本地有效的变量"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#只在本地有效的变量"}},[e._v("#")]),e._v(" 只在本地有效的变量")]),e._v(" "),v("p",[e._v("有的时候你可能有一些不应该提交到代码仓库中的变量，尤其是当你的项目托管在公共仓库时。这种情况下你应该使用一个 "),v("code",[e._v(".env.local")]),e._v(" 文件取而代之。本地环境文件默认会被忽略，且出现在 "),v("code",[e._v(".gitignore")]),e._v(" 中。")]),e._v(" "),v("p",[v("code",[e._v(".local")]),e._v(" 也可以加在指定模式的环境文件上，比如 "),v("code",[e._v(".env.development.local")]),e._v(" 将会在 development 模式下被载入，且被 git 忽略。")])])}),[],!1,null,null,null);t.default=a.exports}}]);